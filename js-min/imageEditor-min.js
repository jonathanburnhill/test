const openModal=document.querySelector("#openModal"),modal=document.querySelector(".modal"),modalFilter=document.querySelector(".modal-filter"),cancel=document.querySelector(".cancel"),save=document.querySelector(".save"),result=document.querySelector(".result"),imgSelect=document.querySelector("#img-select"),filePicker=document.querySelector("#file-picker"),filterStart=document.querySelector(".filter-start"),allowFilter=document.querySelector(".allow-filter"),filterImg=document.querySelector("#canvas"),imageOptions=document.querySelector(".image-options"),add=document.querySelector(".add"),orderNum=document.querySelector(".order-num"),photos=document.querySelector(".photos"),buyNow=document.querySelector(".buy-now");let rawImg;document.querySelector(".to-close").addEventListener("click",()=>{modal.classList.remove("modal-visible")});let containerWidth,viewportSize;499>document.documentElement.clientWidth?(containerWidth=document.documentElement.clientWidth,viewportSize=250):500<document.documentElement.clientWidth&&600>document.documentElement.clientWidth?(containerWidth=500,viewportSize=350,modal.style.height="700px"):(containerWidth=600,viewportSize=400,modal.style.height="800px"),imgSelect.addEventListener("click",function(a){filePicker&&filePicker.click(),a.preventDefault()},!1);var vanilla=new Croppie(result,{viewport:{width:viewportSize,height:viewportSize},boundary:{width:containerWidth,height:containerWidth},enableExif:!0});const chooseImg=function(){const a=new FileReader;a.onload=function(a){modal.classList.add("modal-visible"),rawImg=a.target.result,vanilla.bind({url:rawImg})},a.readAsDataURL(event.target.files[0])};save.addEventListener("click",function(){vanilla.result({type:"base64",format:"jpeg",size:viewportSize}).then(function(a){filterStart.setAttribute("src",a),modal.classList.remove("modal-visible"),filterStart.style.width=`${viewportSize}px`,filterStart.style.height=`${viewportSize}px`,add.disabled=!1,modalFilter.classList.add("modal-visible")})}),document.querySelector("#file-picker").addEventListener("change",chooseImg,!1),cancel.addEventListener("click",()=>{modal.classList.remove("modal-visible")}),save.addEventListener("click",()=>{vanilla.result({type:"base64",format:"webp",type:"canvas",size:"original",quality:1})}),document.querySelector(".back").addEventListener("click",function(){modalFilter.classList.remove("modal-visible"),modal.classList.add("modal-visible")});const img=new Image,applyFilter=a=>document.querySelector(a);applyFilter("#greyscale").addEventListener("click",function(){const a=document.querySelector("#greyscale");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.greyscale().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.greyscale().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Greyscale"})}),applyFilter("#vintage").addEventListener("click",function(){const a=document.querySelector("#vintage");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.vintage().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.vintage().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Vintage"})}),applyFilter("#oldboot").addEventListener("click",function(){const a=document.querySelector("#oldboot");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.oldBoot().render()):modalFilter.classList.contains("allow-filter")?(this.oldBoot().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Old  Boot"})}),applyFilter("#orange-peel").addEventListener("click",function(){const a=document.querySelector("#orange-peel");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.orangePeel().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.orangePeel().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Orange"})}),applyFilter("#love").addEventListener("click",function(){const a=document.querySelector("#love");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.love().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.love().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Love"})}),applyFilter("#sunrise").addEventListener("click",function(){const a=document.querySelector("#sunrise");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.sunrise().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.sunrise().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Sunrise"})}),applyFilter("#hazydays").addEventListener("click",function(){const a=document.querySelector("#hazydays");a.style.backgroundColor="orange",a.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.hazyDays().render(),a.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.hazyDays().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),a.textContent="Hazy"})}),applyFilter("#reset").addEventListener("click",function(){Caman("#canvas",img,function(){this.reloadCanvasData(),this.revert(!1),this.render()})});const priceUpdate=document.querySelector(".price-update");priceUpdate.innerHTML=0;let val=0;document.querySelector(".add").addEventListener("click",function(){Caman("#canvas",img,function(){const a=new Image;a.setAttribute("src",this.toBase64()),a.style.width=`100px`,a.style.height=`100px`,a.setAttribute("class","result-position"),add.disabled=!0,photos.insertAdjacentElement("afterbegin",a),modalFilter.classList.remove("modal-visible"),document.querySelector(".is-hidden").style.display="block",this.reloadCanvasData(),this.revert(!1),document.querySelector(".filter-start").removeAttribute("data-camen-id"),document.querySelector("#file-picker").val="",vanilla.bind({url:""})}),val+=1,orderNum.innerHTML=`${val} x tiles.`,priceUpdate.innerHTML=2>val&&0<val?`£${10*val}`:2<=val&&3>val?`£${10*(.9*val)}`:`£${Math.floor(10*(.8*val))}`,console.log(val)});const fbLogin=function(){const a=document.createElement("button");return a.setAttribute("class","fb-login"),a.onclick=fbLoginSettings(),a};buyNow.addEventListener("click",function(){document.querySelector(".is-hidden").style.display="none",document.querySelector(".buy-now-form").style.display="block"}),Caman("#canvas",img,function(){this.render()}),document.querySelector(".fb-login").addEventListener("click",()=>{const a=new firebase.auth.FacebookAuthProvider,b=firebase.auth().signInWithPopup(a);b.then(function(a){console.log(a),document.querySelector(".buy-now-form").style.display="none",document.querySelector(".address-form").style.display="block"}).catch(function(a){console.log(a)})}),document.querySelector("#btnSignUp").addEventListener("click",()=>{const a=document.querySelector("#txtEmail").value,b=document.querySelector("#txtPassword").value;firebase.auth().createUserWithEmailAndPassword(a,b).catch(function(a){console.log(a.message)})}),document.querySelector("#btnLogin").addEventListener("click",()=>{const a=document.querySelector("#txtEmail").value,b=document.querySelector("#txtPassword").value;firebase.auth().signInWithEmailAndPassword(a,b).catch(a=>console.log(a.message))}),firebase.auth().onAuthStateChanged(a=>{a?document.querySelector("#btnLogOut").classList.remove("hide"):document.querySelector("#btnLogOut").classList.add("hide")}),document.querySelector("#btnLogOut").addEventListener("click",()=>{firebase.auth().signOut(),console.log("logged out")});
