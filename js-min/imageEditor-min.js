const openModal=document.querySelector("#openModal"),modal=document.querySelector(".modal"),modalFilter=document.querySelector(".modal-filter"),cancel=document.querySelector(".cancel"),save=document.querySelector(".save"),result=document.querySelector(".result"),imgSelect=document.querySelector("#img-select"),filePicker=document.querySelector("#file-picker"),filterStart=document.querySelector(".filter-start"),allowFilter=document.querySelector(".allow-filter"),filterImg=document.querySelector("#canvas"),imageOptions=document.querySelector(".image-options"),add=document.querySelector(".add"),orderNum=document.querySelector(".order-num"),photos=document.querySelector(".photos"),buyNow=document.querySelector(".buy-now");let rawImg,containerWidth,viewportSize;document.querySelector(".to-close").addEventListener("click",()=>{modal.classList.remove("modal-visible")}),document.documentElement.clientWidth<499?(containerWidth=document.documentElement.clientWidth,viewportSize=250):document.documentElement.clientWidth>500&&document.documentElement.clientWidth<600?(containerWidth=500,viewportSize=350,modal.style.height="700px"):(containerWidth=600,viewportSize=400,modal.style.height="800px"),imgSelect.addEventListener("click",function(e){filePicker&&filePicker.click(),e.preventDefault()},!1);var vanilla=new Croppie(result,{viewport:{width:viewportSize,height:viewportSize},boundary:{width:containerWidth,height:containerWidth},enableExif:!0});const chooseImg=function(e){const t=new FileReader;t.onload=function(e){modal.classList.add("modal-visible"),rawImg=e.target.result,vanilla.bind({url:rawImg})},t.readAsDataURL(event.target.files[0])};save.addEventListener("click",function(){vanilla.result({type:"base64",format:"jpeg",size:viewportSize}).then(function(e){filterStart.setAttribute("src",e),modal.classList.remove("modal-visible"),filterStart.style.width=`${viewportSize}px`,filterStart.style.height=`${viewportSize}px`,add.disabled=!1,modalFilter.classList.add("modal-visible")})}),document.querySelector("#file-picker").addEventListener("change",chooseImg,!1),cancel.addEventListener("click",()=>{modal.classList.remove("modal-visible")}),save.addEventListener("click",e=>{vanilla.result({type:"base64",format:"webp",type:"canvas",size:"original",quality:1})}),document.querySelector(".back").addEventListener("click",function(e){modalFilter.classList.remove("modal-visible"),modal.classList.add("modal-visible")});const img=new Image,applyFilter=e=>document.querySelector(e);applyFilter("#greyscale").addEventListener("click",function(e){const t=document.querySelector("#greyscale");t.style.backgroundColor="orange",t.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.greyscale().render(),t.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.greyscale().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),t.textContent="Greyscale"})}),applyFilter("#vintage").addEventListener("click",function(){const e=document.querySelector("#vintage");e.style.backgroundColor="orange",e.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.vintage().render(),e.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.vintage().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),e.textContent="Vintage"})}),applyFilter("#oldboot").addEventListener("click",function(e){const t=document.querySelector("#oldboot");t.style.backgroundColor="orange",t.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.oldBoot().render()):modalFilter.classList.contains("allow-filter")?(this.oldBoot().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),t.textContent="Old  Boot"})}),applyFilter("#orange-peel").addEventListener("click",function(){const e=document.querySelector("#orange-peel");e.style.backgroundColor="orange",e.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.orangePeel().render(),e.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.orangePeel().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),e.textContent="Orange"})}),applyFilter("#love").addEventListener("click",function(){const e=document.querySelector("#love");e.style.backgroundColor="orange",e.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.love().render(),e.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.love().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),e.textContent="Love"})}),applyFilter("#sunrise").addEventListener("click",function(){const e=document.querySelector("#sunrise");e.style.backgroundColor="orange",e.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.sunrise().render(),e.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.sunrise().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),e.textContent="Sunrise"})}),applyFilter("#hazydays").addEventListener("click",function(){const e=document.querySelector("#hazydays");e.style.backgroundColor="orange",e.textContent="Loading...",Caman("#canvas",img,function(){modalFilter.classList.contains("checked")?(this.reloadCanvasData(),this.revert(!1),this.render(),this.hazyDays().render(),e.style.backgroundColor="#f70d0e"):modalFilter.classList.contains("allow-filter")?(this.hazyDays().render(),modalFilter.classList.remove("allow-filter"),modalFilter.classList.add("checked")):(this.reloadCanvasData(),this.revert(!1),this.render(),modalFilter.classList.add("allow-filter")),e.textContent="Hazy"})}),applyFilter("#reset").addEventListener("click",function(e){Caman("#canvas",img,function(){this.reloadCanvasData(),this.revert(!1),this.render()})});const priceUpdate=document.querySelector(".price-update");priceUpdate.innerHTML=0;let val=0;document.querySelector(".add").addEventListener("click",function(){Caman("#canvas",img,function(){const e=new Image;e.setAttribute("src",this.toBase64()),e.style.width="100px",e.style.height="100px",e.setAttribute("class","result-position"),add.disabled=!0,photos.insertAdjacentElement("afterbegin",e),modalFilter.classList.remove("modal-visible"),document.querySelector(".is-hidden").style.display="block",this.reloadCanvasData(),this.revert(!1),document.querySelector(".filter-start").removeAttribute("data-camen-id"),document.querySelector("#file-picker").val="",vanilla.bind({url:""})}),val+=1,orderNum.innerHTML=`${val} x tiles.`,priceUpdate.innerHTML=val<2&&val>0?`£${10*val}`:val>=2&&val<3?`£${.9*val*10}`:`£${Math.floor(.8*val*10)}`,console.log(val)});const fbLogin=function(){const e=document.createElement("button");return e.setAttribute("class","fb-login"),e.onclick=fbLoginSettings(),e};buyNow.addEventListener("click",function(){document.querySelector(".is-hidden").style.display="none",document.querySelector(".buy-now-form").style.display="block"}),Caman("#canvas",img,function(){this.render()}),document.querySelector(".fb-login").addEventListener("click",e=>{const t=new firebase.auth.FacebookAuthProvider;firebase.auth().signInWithPopup(t).then(function(e){console.log(e),document.querySelector(".buy-now-form").style.display="none",document.querySelector(".address-form").style.display="block"}).catch(function(e){console.log(e)})}),document.querySelector("#btnSignUp").addEventListener("click",e=>{const t=document.querySelector("#txtEmail").value,a=document.querySelector("#txtPassword").value;firebase.auth().createUserWithEmailAndPassword(t,a).catch(function(e){console.log(e.message)})}),document.querySelector("#btnLogin").addEventListener("click",e=>{const t=document.querySelector("#txtEmail").value,a=document.querySelector("#txtPassword").value;firebase.auth().signInWithEmailAndPassword(t,a).catch(e=>console.log(e.message))}),firebase.auth().onAuthStateChanged(e=>{e?document.querySelector("#btnLogOut").classList.remove("hide"):document.querySelector("#btnLogOut").classList.add("hide")}),document.querySelector("#btnLogOut").addEventListener("click",e=>{firebase.auth().signOut(),console.log("logged out")});